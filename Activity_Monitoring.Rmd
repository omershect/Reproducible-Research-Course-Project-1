---
title: "Reproducible Research: Course Project 1"
Author:
        "Omer Shechter"
Date:
        "20/09/2018"
output: 
  html_document:
    keep_md: true
---
## Data Loading
Download the files and unzip them into a data directory 
Check if data directory exist, if not create it
Than download the data and unzip it if not allredy exist
Read the Dataset into a datframe - Activity_DF
```{r}
if(!file.exists("data")) {  
        dir.create("data")  
}  
if(!file.exists("./data/Activity.zip")) {  
        fileUrl <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"  
        download.file(fileUrl, destfile="./data/Activity.zip")  
        if(file.exists("./data/Activity.zip"))   
                unzip("./data/Activity.zip",exdir="./data")  
}
Activity_DF<-read.csv("./data/Activity.csv",sep = ",")
```


## First look at the dataset

```{r}
str(Activity_DF)
#Show only the non missing values in steps 
head(Activity_DF[which(!is.na(Activity_DF$steps)), ])
summary(Activity_DF)
```


## What is mean total number of steps taken per day?


Group the number of steps by date and intervals. 
Find the total number of steps per day over all days. 
some of the days have no steps data. 
This will be not shwon in the plot.

```{r}
#Create a dataframe with  total steps per day  and dates
Steps_Per_Day<-data.frame(date = unique(as.Date(Activity_DF$date,"%Y-%m-%d")), Total.Steps = tapply(Activity_DF$steps,as.Date(Activity_DF$date,"%Y-%m-%d"),sum))

head(Steps_Per_Day)
```

Plot the Histogram of the total steps per day (Including NA values)
```{r Histogram Plot}
##Load ggplot2
library(ggplot2)

#Plot the Histogram (with missing values)
qplot(Steps_Per_Day$Total.Steps, geom="histogram",bins=10,xlab = "Steps",ylab = "Count",main = "Total Steps per day Histogram")  

```



Calculate the mean and median per day 
```{r}
#Add the mean and median steps per day to the Steps_Per_Day
Steps_Per_Day<-cbind(Steps_Per_Day,data.frame(Steps.mean = tapply(Activity_DF$steps,as.Date(Activity_DF$date,"%Y-%m-%d"),mean)))

Steps_Per_Day<-cbind(Steps_Per_Day,data.frame(Steps.median = tapply(Activity_DF$steps,as.Date(Activity_DF$date,"%Y-%m-%d"),median)))
head(Steps_Per_Day)

```

## What is the average daily activity pattern?

Calculate the averge steps per interval
```{r}
#Calculate the averge steps per interval (NA Remove)
Steps_Per_Interval<-aggregate(Activity_DF$steps, 
                       by=list(Activity_DF$interval), 
                       FUN=mean, 
                       na.rm=TRUE)
#calculate The 5-minute interval that, on average, holds the maximum number of steps
sprintf("The 5-minutes interval that, on average, holds the maximum number of steps is: %i",Steps_Per_Interval[which.max(Steps_Per_Interval$x), ]$Group.1)


```

Time series plot of the average number of steps taken using ggplot 
```{r}
#Load ggplot2
library(ggplot2)
#plot a time serial of the avaarge number of stesp (withot missing values)
ggplot(data=Steps_Per_Interval,aes(y=x,x=Group.1))+geom_line()+labs(y="Avarage number of steps",x = "Interval in minutes", title = "Time series of the average number of steps taken (NA Removed)")

```



## Imputing missing values
This data set contain some dyas which are data is missing
Calculate what is the amountof data mising and what is the percantage
```{r}
#overall NA Samples
NA_count <- sum(is.na(Activity_DF$steps))
#Precentage of missing data 
NA_Precentage<-sum(is.na(Activity_DF$steps)) /length(Activity_DF$steps) * 100
sprintf("Overall Steps Data misiing is %f in Precentage %f%%",NA_count,NA_Precentage)
```

The amount of the missing data is not negligible 
In order to overcome the NA values will be replaced by the mean value per day

```{r}
#calaculate the positin of the NA values 
NA_Vector_Pos<-which(is.na(Activity_DF$steps))
```



## Are there differences in activity patterns between weekdays and weekends?
